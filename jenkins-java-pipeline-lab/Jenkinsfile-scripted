node {
    stage('Build') {
        // Get build number
        def buildNum = env.BUILD_NUMBER.toInteger()
        echo "Build Number: ${buildNum}"

        // Check if build number > 5
        if (buildNum > 5) {
            error("Build number greater than 5! Stopping pipeline.")
        }

        // Build Java project
        sh 'mvn clean package'
    }

    stage('Deploy') {
        // Deploy only if branch is main
        if (env.BRANCH_NAME == 'main') {
            echo "ğŸš€ Deploying application..."
            sh 'echo "Deployed!"' // replace with real deploy command
        }
    }

    post {
        always {
            echo 'Pipeline finished.'
        }
        success {
            echo 'ğŸ‰ Build succeeded!'
        }
        failure {
            echo 'âŒ Build failed!'
        }
    }
}
